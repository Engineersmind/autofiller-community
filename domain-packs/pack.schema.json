{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://autofiller.dev/schemas/pack.schema.json",
  "title": "Domain Pack Manifest",
  "description": "Schema for Autofiller domain pack manifest (pack.yaml)",
  "type": "object",
  "required": ["name", "version", "description", "owners", "schema", "eval", "constraints"],
  "properties": {
    "name": {
      "type": "string",
      "pattern": "^[a-z0-9-]+$",
      "description": "Unique pack identifier (kebab-case)",
      "examples": ["invoice-standard", "tax-w2"]
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Semantic version (MAJOR.MINOR.PATCH)",
      "examples": ["1.0.0", "0.1.0"]
    },
    "description": {
      "type": "string",
      "minLength": 10,
      "maxLength": 500,
      "description": "Human-readable description of the document type"
    },
    "owners": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["github"],
        "properties": {
          "github": {
            "type": "string",
            "description": "GitHub username"
          },
          "email": {
            "type": "string",
            "format": "email",
            "description": "Optional contact email"
          }
        }
      },
      "description": "Pack maintainers"
    },
    "schema": {
      "type": "string",
      "description": "Path to JSON Schema file (relative to pack directory)",
      "default": "schema.json"
    },
    "routing": {
      "type": "object",
      "description": "Document routing/detection configuration",
      "properties": {
        "keywords": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Keywords that indicate this document type"
        },
        "anchors": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Text anchors that increase confidence"
        },
        "file_patterns": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Filename patterns (glob) for auto-routing"
        }
      }
    },
    "eval": {
      "type": "object",
      "required": ["cases", "expected_dir", "metrics"],
      "properties": {
        "cases": {
          "type": "string",
          "description": "Path to eval cases JSONL file",
          "default": "eval/cases.jsonl"
        },
        "expected_dir": {
          "type": "string",
          "description": "Directory containing expected output JSON files",
          "default": "eval/expected"
        },
        "metrics": {
          "type": "string",
          "description": "Path to metrics configuration file",
          "default": "eval/metrics.yaml"
        },
        "fixtures_dir": {
          "type": "string",
          "description": "Directory containing test fixtures",
          "default": "fixtures"
        }
      }
    },
    "constraints": {
      "type": "object",
      "required": ["pii_policy"],
      "properties": {
        "pii_policy": {
          "type": "string",
          "enum": ["synthetic-or-redacted-only", "synthetic-only", "no-pii"],
          "description": "Policy for PII in test fixtures"
        },
        "max_pages": {
          "type": "integer",
          "minimum": 1,
          "maximum": 100,
          "description": "Maximum number of pages supported"
        },
        "supported_formats": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["pdf", "png", "jpg", "jpeg", "tiff", "tif"]
          },
          "description": "Supported file formats"
        },
        "languages": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Supported languages (ISO 639-1 codes)"
        }
      }
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata",
      "properties": {
        "tags": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Categorization tags"
        },
        "industry": {
          "type": "string",
          "description": "Target industry (finance, healthcare, legal, etc.)"
        },
        "region": {
          "type": "string",
          "description": "Geographic region (US, EU, global, etc.)"
        }
      }
    }
  },
  "additionalProperties": false
}
